{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { reactive, toRefs, computed } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRoute, useRouter } from \"vue-router\";\nexport default {\n  setup() {\n    const store = useStore();\n    const route = useRoute();\n    const router = useRouter();\n    const state = reactive({\n      buttonClicked: false,\n      previewImage: null,\n      image: null\n    });\n    const house = computed(() => {\n      return store.getters.getByIdEditModel(route.params.houseId);\n    });\n    function uploadImageTest() {\n      const formData = new FormData();\n      formData.append('image', state.image);\n      const apiKey = \"PBknlDMOSUux9sEyo0ivKtma64f13FVR\";\n      fetch(`https://api.intern.d-tt.nl/api/houses/${route.params.houseId}/upload`, {\n        method: 'POST',\n        headers: {\n          \"X-Api-Key\": apiKey\n        },\n        body: formData\n      }).then(response => {\n        if (response.ok) {\n          console.log('Image uploaded successfully');\n        } else {\n          console.error('Error uploading image');\n        }\n      }).catch(error => {\n        console.error('Error uploading image', error);\n      });\n    }\n\n    // function uploadHouseListingImage() {\n    //   const formData = new FormData()\n    //   formData.append('image', state.image)\n\n    //   console.log('formData')\n    //   console.log(state.image)\n    //   console.log(state.image.name)\n    //   console.log(formData.getAll)\n    //   console.log('formData')\n\n    //   if (state.previewImage) {\n    //     store\n    //     .dispatch(\"uploadHouseImg\", { id: route.params.houseId, body: formData})\n    //     .then(() => {\n    //       // API success\n    //       console.log(\"img uploaded\");\n    //     })\n    //     .catch((e) => {\n    //       // API fail\n    //       console.log(\"error in request upload\", e);\n    //     });\n    //   }\n    // }\n\n    function submitButtonClicked() {\n      state.buttonClicked = true;\n    }\n    function editHouseListing() {\n      store.dispatch(\"editHouse\", {\n        id: route.params.houseId,\n        body: house.value\n      }).then(() => {\n        // API success\n        uploadImageTest();\n        console.log(\"data edited\");\n      }).finally(() => router.push({\n        name: \"home\"\n      })).catch(e => {\n        // API fail\n        console.log(\"error in request edit\", e);\n      });\n    }\n    function createHouseListing() {\n      store.dispatch(\"createHouse\", house.value).then(() => {\n        // API success\n        router.push({\n          name: \"home\"\n        });\n        console.log(\"data created\");\n      }).catch(e => {\n        // API fail\n        console.log(\"error in request create\", e);\n      });\n    }\n    function submitForm() {\n      if (route.params.houseId) editHouseListing();else createHouseListing();\n    }\n    function uploadImage(e) {\n      const image = e.target.files[0];\n      state.image = image;\n      const reader = new FileReader();\n      reader.readAsDataURL(image);\n      reader.onload = e => {\n        this.previewImage = e.target.result;\n        console.log(this.previewImage);\n      };\n    }\n    return {\n      ...toRefs(state),\n      house,\n      submitForm,\n      submitButtonClicked,\n      uploadImage,\n      route\n    };\n  }\n};","map":{"version":3,"mappings":"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","names":["reactive","toRefs","computed","useStore","useRoute","useRouter","setup","store","route","router","state","buttonClicked","previewImage","image","house","getters","getByIdEditModel","params","houseId","uploadImageTest","formData","FormData","append","apiKey","fetch","method","headers","body","then","response","ok","console","log","error","catch","submitButtonClicked","editHouseListing","dispatch","id","value","finally","push","name","e","createHouseListing","submitForm","uploadImage","target","files","reader","FileReader","readAsDataURL","onload","result"],"sourceRoot":"","sources":["/Users/frostmoon/Documents/DTT projects/Vue js/house-listing-app/src/views/CreateHouseView.vue"],"sourcesContent":["<template>\n  <div class=\"root\">\n    <div class=\"create-house-container\">\n      <router-link to=\"/\" style=\"text-decoration: none; color: inherit\">\n        <div class=\"back-button\">\n          <img\n            src=\"@/assets/ic_back_grey@3x.png\"\n            alt=\"ic_back\"\n            width=\"20\"\n            height=\"20\"\n          />\n          <div class=\"back-button-label\">Back to overview</div>\n        </div>\n      </router-link>\n      <div>\n        <div v-if=\"route.params.houseId\" class=\"header1\">Edit dlisting</div>\n        <div v-else class=\"header1\">Create new listing</div>\n        <form @submit.prevent=\"submitForm\">\n          <div class=\"input-field-title\">Street name*</div>\n          <input\n            type=\"text\"\n            placeholder=\"Enter the street name\"\n            v-model=\"house.streetName\"\n            :class=\"{ error: !house.streetName && buttonClicked }\"\n            required\n          />\n          <div class=\"flex\">\n            <div>\n              <div class=\"input-field-title\">House number*</div>\n              <input\n                type=\"number\"\n                placeholder=\"Enter the house number\"\n                v-model=\"house.houseNumber\"\n                :class=\"{ error: !house.houseNumber && buttonClicked }\"\n                required\n              />\n            </div>\n            <div class=\"spacer\" />\n            <div>\n              <div class=\"input-field-title\">Addition (optional)</div>\n              <input\n                type=\"number\"\n                placeholder=\"e.g. A\"\n                v-model=\"house.numberAddition\"\n              />\n            </div>\n          </div>\n          <div class=\"input-field-title\">Postal Code*</div>\n          <input\n            type=\"text\"\n            placeholder=\"e.g. 1000 AA\"\n            v-model=\"house.zip\"\n            :class=\"{ error: !house.zip && buttonClicked }\"\n            required\n          />\n          <div class=\"input-field-title\">City*</div>\n          <input\n            type=\"text\"\n            placeholder=\"e.g. Utrecht\"\n            v-model=\"house.city\"\n            :class=\"{ error: !house.city && buttonClicked }\"\n            required\n          />\n          <div class=\"input-field-title\">Upload picture (PNG or JPG)*</div>\n\n          <div>\n            <img v-if=\"previewImage\" :src=\"previewImage\" alt=\"upload\" class=\"uploading-image\"/>\n            <img v-else src=\"@/assets/ic_upload@3x.png\" class=\"uploading-image\"/>\n            <input type=\"file\" accept=\"image/jpeg\" @change=\"uploadImage\">\n          </div>\n          <div class=\"input-field-title\">Price*</div>\n          <input\n            type=\"number\"\n            placeholder=\"e.g. €150.000\"\n            v-model=\"house.price\"\n            :class=\"{ error: !house.price && buttonClicked }\"\n            required\n          />\n          <div class=\"flex\">\n            <div>\n              <div class=\"input-field-title\">Size*</div>\n              <input\n                type=\"number\"\n                placeholder=\"e.g. 60m²\"\n                v-model=\"house.size\"\n                :class=\"{ error: !house.size && buttonClicked }\"\n                required\n              />\n            </div>\n            <div class=\"spacer\" />\n            <div>\n              <div class=\"input-field-title\">Garage*</div>\n              <input\n                type=\"text\"\n                placeholder=\"Select\"\n                v-model=\"house.hasGarage\"\n              />\n            </div>\n          </div>\n          <div class=\"flex\">\n            <div>\n              <div class=\"input-field-title\">Bedrooms*</div>\n              <input\n                type=\"number\"\n                placeholder=\"Enter amount\"\n                v-model=\"house.bedrooms\"\n                :class=\"{ error: !house.bedrooms && buttonClicked }\"\n                required\n              />\n            </div>\n            <div class=\"spacer\" />\n            <div>\n              <div class=\"input-field-title\">Bathrooms*</div>\n              <input\n                type=\"number\"\n                placeholder=\"Enter amount\"\n                v-model=\"house.bathrooms\"\n                :class=\"{ error: !house.bathrooms && buttonClicked }\"\n                required\n              />\n            </div>\n          </div>\n          <div class=\"input-field-title\">Construction date*</div>\n          <input\n            type=\"number\"\n            placeholder=\"e.g. 1900\"\n            v-model=\"house.constructionYear\"\n            :class=\"{ error: !house.constructionYear && buttonClicked }\"\n            required\n          />\n          <div class=\"input-field-title\">Description*</div>\n          <textarea\n            name=\"\"\n            id=\"\"\n            cols=\"30\"\n            rows=\"10\"\n            placeholder=\"Enter description\"\n            v-model=\"house.description\"\n            :class=\"{ error: !house.description && buttonClicked }\"\n            required\n          />\n          <div class=\"btn-container\">\n            <button class=\"btn\" @click=\"submitButtonClicked\">POST</button>\n          </div>\n          <br />\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs, computed } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRoute, useRouter } from \"vue-router\";\n\nexport default {\n  setup() {\n    const store = useStore();\n    const route = useRoute();\n    const router = useRouter();\n\n    const state = reactive({\n      buttonClicked: false,\n      previewImage: null,\n      image: null\n    });\n\n    const house = computed(() => {\n      return store.getters.getByIdEditModel(route.params.houseId);\n    });\n\n\n    function uploadImageTest() {\n      const formData = new FormData();\n      formData.append('image', state.image);\n      const apiKey = \"PBknlDMOSUux9sEyo0ivKtma64f13FVR\";\n\n      fetch(`https://api.intern.d-tt.nl/api/houses/${route.params.houseId}/upload`, {\n        method: 'POST',\n        headers: {\n          \"X-Api-Key\": apiKey,\n        },\n        body: formData\n      })\n      .then(response => {\n        if (response.ok) {\n          console.log('Image uploaded successfully');\n        } else {\n          console.error('Error uploading image');\n        }\n      })\n      .catch(error => {\n        console.error('Error uploading image', error);\n      });\n    }\n\n\n    // function uploadHouseListingImage() {\n    //   const formData = new FormData()\n    //   formData.append('image', state.image)\n\n    //   console.log('formData')\n    //   console.log(state.image)\n    //   console.log(state.image.name)\n    //   console.log(formData.getAll)\n    //   console.log('formData')\n\n    //   if (state.previewImage) {\n    //     store\n    //     .dispatch(\"uploadHouseImg\", { id: route.params.houseId, body: formData})\n    //     .then(() => {\n    //       // API success\n    //       console.log(\"img uploaded\");\n    //     })\n    //     .catch((e) => {\n    //       // API fail\n    //       console.log(\"error in request upload\", e);\n    //     });\n    //   }\n    // }\n\n    function submitButtonClicked() {\n      state.buttonClicked = true;\n    }\n\n    function editHouseListing() {\n      store\n        .dispatch(\"editHouse\", { id: route.params.houseId, body: house.value })\n        .then(() => {\n          // API success\n          uploadImageTest()\n          console.log(\"data edited\");\n        })\n        .finally(() => router.push({ name: \"home\" }))\n        .catch((e) => {\n          // API fail\n          console.log(\"error in request edit\", e);\n        });\n      \n    }\n\n    function createHouseListing() {\n      store\n        .dispatch(\"createHouse\", house.value)\n        .then(() => {\n          // API success\n          router.push({ name: \"home\" });\n          console.log(\"data created\");\n        })\n        .catch((e) => {\n          // API fail\n          console.log(\"error in request create\", e);\n        });\n    }\n\n    function submitForm() {\n      if (route.params.houseId) editHouseListing();\n      else createHouseListing();\n    }\n\n    function uploadImage(e) {\n      const image = e.target.files[0];\n      state.image = image\n      const reader = new FileReader();\n      reader.readAsDataURL(image);\n      reader.onload = (e) => {\n        this.previewImage = e.target.result;\n        console.log(this.previewImage);\n      };\n    }\n\n    return {\n      ...toRefs(state),\n      house,\n      submitForm,\n      submitButtonClicked,\n      uploadImage,\n      route,\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.root {\n  margin: 0;\n  padding: 0;\n  background-image: url(\"/src/assets/img_background@3x.png\");\n  background-repeat: no-repeat;\n  background-size: 105%;\n\n  .create-house-container {\n    margin: 30px 0 0 15%;\n    .back-button {\n      margin-bottom: 20px;\n    }\n    .header1 {\n      margin-bottom: 20px;\n    }\n\n    .flex {\n      display: flex;\n    }\n    .input-field-title {\n      margin: 10px 0;\n    }\n    .spacer {\n      width: 20px;\n    }\n    .btn-container {\n      margin: 50px 275px;\n    }\n    .uploading-image {\n      width: 100px;\n      height: 100px;\n      border-radius: 5px;\n    }\n    .error {\n      border: 1px solid red;\n      &::placeholder {\n        color: red;\n        opacity: 1; /* Firefox */\n      }\n\n      &:-ms-input-placeholder {\n        /* Internet Explorer 10-11 */\n        color: red;\n      }\n\n      &::-ms-input-placeholder {\n        /* Microsoft Edge */\n        color: red;\n      }\n    }\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}