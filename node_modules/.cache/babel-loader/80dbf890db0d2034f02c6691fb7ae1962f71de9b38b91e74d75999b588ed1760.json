{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '@/assets/ic_back_grey@3x.png';\nconst _withScopeId = n => (_pushScopeId(\"data-v-0b17c4d6\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"root\"\n};\nconst _hoisted_2 = {\n  class: \"create-house-container\"\n};\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"back-button\"\n}, [/*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_0,\n  alt: \"ic_back\",\n  width: \"20\",\n  height: \"20\"\n}), /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"back-button-label\"\n}, \"Back to overview\")], -1 /* HOISTED */));\nconst _hoisted_4 = {\n  key: 0,\n  class: \"header1\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"header1\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  const _component_house_listing_form = _resolveComponent(\"house-listing-form\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_router_link, {\n    to: \"/\",\n    style: {\n      \"text-decoration\": \"none\",\n      \"color\": \"inherit\"\n    }\n  }, {\n    default: _withCtx(() => [_hoisted_3]),\n    _: 1 /* STABLE */\n  }), _createElementVNode(\"div\", null, [$setup.route.params.houseId ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, \"Edit dlisting\")) : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, \"Create new listing\")), _createVNode(_component_house_listing_form, {\n    onSubmitForm: $setup.submitForm,\n    onSelectImage: $setup.selectImage,\n    houseId: $setup.route.params.houseId\n  }, null, 8 /* PROPS */, [\"onSubmitForm\", \"onSelectImage\", \"houseId\"])])])]);\n}","map":{"version":3,"mappings":";OAMYA,UAAkC;;;EALvCC,KAAK,EAAC;AAAM;;EACVA,KAAK,EAAC;AAAwB;gEAE/BC,oBAQM;EARDD,KAAK,EAAC;AAAa,iBACtBC,oBAKE;EAJAC,GAAkC,EAAlCH,UAAkC;EAClCI,GAAG,EAAC,SAAS;EACbC,KAAK,EAAC,IAAI;EACVC,MAAM,EAAC;iBAETJ,oBAAqD;EAAhDD,KAAK,EAAC;AAAmB,GAAC,kBAAgB;;;EAIhBA,KAAK,EAAC;;;;EAC3BA,KAAK,EAAC;;;;;uBAfxBM,oBAuBM,OAvBNC,UAuBM,GAtBJN,oBAqBM,OArBNO,UAqBM,GApBJC,aAUcC;IAVDC,EAAE,EAAC,GAAG;IAACC,KAA6C,EAA7C;MAAA;MAAA;IAAA;;sBAClB,MAQM,CARNC,UAQM;;MAERZ,oBAQM,cAPOa,YAAK,CAACC,MAAM,CAACC,OAAO,kBAA/BV,oBAAoE,OAApEW,UAAoE,EAAnB,eAAa,oBAC9DX,oBAAoD,OAApDY,UAAoD,EAAxB,oBAAkB,IAC9CT,aAIEU;IAHCC,YAAU,EAAEN,iBAAU;IACtBO,aAAW,EAAEP,kBAAW;IACxBE,OAAO,EAAEF,YAAK,CAACC,MAAM,CAACC","names":["_imports_0","class","_createElementVNode","src","alt","width","height","_createElementBlock","_hoisted_1","_hoisted_2","_createVNode","_component_router_link","to","style","_hoisted_3","$setup","params","houseId","_hoisted_4","_hoisted_5","_component_house_listing_form","onSubmitForm","onSelectImage"],"sourceRoot":"","sources":["/Users/frostmoon/Documents/DTT projects/Vue js/house-listing-app/src/views/CreateEditHouseView.vue"],"sourcesContent":["<template>\n  <div class=\"root\">\n    <div class=\"create-house-container\">\n      <router-link to=\"/\" style=\"text-decoration: none; color: inherit\">\n        <div class=\"back-button\">\n          <img\n            src=\"@/assets/ic_back_grey@3x.png\"\n            alt=\"ic_back\"\n            width=\"20\"\n            height=\"20\"\n          />\n          <div class=\"back-button-label\">Back to overview</div>\n        </div>\n      </router-link>\n      <div>\n        <div v-if=\"route.params.houseId\" class=\"header1\">Edit dlisting</div>\n        <div v-else class=\"header1\">Create new listing</div>\n        <house-listing-form\n          @submitForm=\"submitForm\"\n          @selectImage=\"selectImage\"\n          :houseId=\"route.params.houseId\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport HouseListingForm from \"@/components/HouseListingFormComponent.vue\";\n\nexport default {\n  setup() {\n    const store = useStore();\n    const route = useRoute();\n    const router = useRouter();\n\n    const state = reactive({\n      image: null,\n      previewImage: null,\n    });\n\n    function selectImage(data) {\n      state.image = data.image;\n      state.previewImage = data.previewImage;\n    }\n\n    function uploadHouseListingImage(id) {\n      const formData = new FormData();\n      formData.append(\"image\", state.image);\n      if (state.previewImage) {\n        store\n          .dispatch(\"uploadHouseImg\", {\n            id: id,\n            body: formData,\n            value: state.previewImage,\n          })\n          .then(() => {\n            // API success\n            console.log(\"img uploaded\");\n            router.push({ name: \"home\" });\n          })\n          .catch((e) => {\n            // API fail\n            console.log(\"error in request upload\", e);\n          });\n      } else {\n        router.push({ name: \"home\" });\n      }\n    }\n\n    function editHouseListing(houseModel) {\n      store\n        .dispatch(\"editHouse\", { id: route.params.houseId, body: houseModel })\n        .then(() => {\n          // API success\n          uploadHouseListingImage(route.params.houseId);\n          console.log(\"data edited\");\n        })\n        .catch((e) => {\n          // API fail\n          console.log(\"error in request edit\", e);\n        });\n    }\n\n    function createHouseListing(houseModel) {\n      store\n        .dispatch(\"createHouse\", houseModel)\n        .then((data) => {\n          // API success\n          uploadHouseListingImage(data.id);\n          console.log(\"data created\");\n        })\n        .catch((e) => {\n          // API fail\n          console.log(\"error in request create\", e);\n        });\n    }\n\n    function submitForm(houseModel) {\n      if (route.params.houseId) editHouseListing(houseModel);\n      else createHouseListing(houseModel);\n    }\n\n    return {\n      ...toRefs(state),\n\n      submitForm,\n      selectImage,\n\n      route,\n    };\n  },\n  components: {\n    HouseListingForm,\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.root {\n  margin: 0;\n  padding: 0;\n  background-image: url(\"/src/assets/img_background@3x.png\");\n\n  /* Full height */\n  height: 100%;\n\n  /* Center and scale the image nicely */\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: cover;\n\n  .create-house-container {\n    margin: 30px 0 0 15%;\n    .back-button {\n      margin-bottom: 20px;\n    }\n  }\n\n  .header1 {\n    margin-bottom: 20px;\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}